#### 线性模型-普通最小二乘法线性回归

+ **code**

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.metrics import mean_squared_error
from sklearn import linear_model

x = np.random.rand(100)
x_train = x[0:50,np.newaxis]
x_test = x[50:100,np.newaxis]
y = 2 * x + 4 + np.random.rand(100)
y_train = y[0:50]
y_test = y[50:100]

regr = linear_model.LinearRegression()
regr.fit(x_train, y_train)
y_pred = regr.predict(x_test)
print('y=%.1f(x)+%.1f' % (regr.coef_[0], regr.intercept_))
print(y_test.shape, x_test.shape, regr.coef_.shape)
print("MSE= %.1f" % mean_squared_error(y_test, y_pred))

plt.scatter(x_test,y_test,c='black')
plt.plot(x_test, y_pred, c='blue')
plt.show()
```

+ **output**

```
y=2.0(x)+4.5
(50,) (50, 1) (1,)
MSE= 0.1
```

![img](pic/1.png)